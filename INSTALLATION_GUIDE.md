# üöÄ –ü–û–õ–ù–û–ï –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –£–°–¢–ê–ù–û–í–ö–ï –°–ò–°–¢–ï–ú–´ –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–û–í

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
2. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
3. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-postgresql)
4. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
5. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ PHP API](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-php-api)
6. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nexar/Octopart](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-nexaroctopart)
7. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ TME](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-tme)
8. [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤](#—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ-–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤)
9. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–∏—Ç—Ä–∏–∫—Å](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-–±–∏—Ç—Ä–∏–∫—Å)
10. [–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è](#–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è)

---

## üéØ –û–ë–ó–û–† –°–ò–°–¢–ï–ú–´

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:

### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. **PostgreSQL –ë–î** - —Ö—Ä–∞–Ω–µ–Ω–∏–µ 1+ –º–ª–Ω –∞—Ä—Ç–∏–∫—É–ª–æ–≤, —Ä–∞—Å—á–µ—Ç–æ–≤, –∏—Å—Ç–æ—Ä–∏–∏
2. **PHP API** - –±—ç–∫–µ–Ω–¥ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Nexar/Octopart –∏ TME
3. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä** - –ø–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
4. **–ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä** - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
5. **–ú–æ–¥—É–ª—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ TME** - –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –∏ –Ω–∞–ª–∏—á–∏—è
6. **–ú–æ–¥—É–ª—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ë–∏—Ç—Ä–∏–∫—Å** - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞

### **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ 1+ –º–∏–ª–ª–∏–æ–Ω –∞—Ä—Ç–∏–∫—É–ª–æ–≤
- ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω —á–µ—Ä–µ–∑ TME API
- ‚úÖ –ü–æ–∏—Å–∫ –¥–µ—Ç–∞–ª–µ–π —á–µ—Ä–µ–∑ Nexar/Octopart
- ‚úÖ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Ä–∞—Å—á–µ—Ç–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–∏—Ç—Ä–∏–∫—Å –∏ OpenCart
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üîß –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### **–°–µ—Ä–≤–µ—Ä:**
- OS: CentOS 7 / Ubuntu 20.04+
- RAM: –º–∏–Ω–∏–º—É–º 4GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8GB)
- CPU: 2+ —è–¥—Ä–∞
- –î–∏—Å–∫: 50GB+ SSD

### **–°–æ—Ñ—Ç:**
```bash
- PostgreSQL 14+
- PHP 7.4+ (–ª—É—á—à–µ 8.0+)
- Nginx –∏–ª–∏ Apache
- Composer (–¥–ª—è PHP –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- Cron (–¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏)
```

### **PHP —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:**
```bash
php-pgsql
php-curl
php-json
php-mbstring
php-xml
```

---

## üì¶ –£–°–¢–ê–ù–û–í–ö–ê POSTGRESQL

### **CentOS 7:**

```bash
# 1. –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π PostgreSQL 14
sudo yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm

# 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º PostgreSQL
sudo yum install -y postgresql14-server postgresql14-contrib

# 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
sudo /usr/pgsql-14/bin/postgresql-14-setup initdb

# 4. –ó–∞–ø—É—Å–∫–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É
sudo systemctl enable postgresql-14
sudo systemctl start postgresql-14

# 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
sudo systemctl status postgresql-14
```

### **Ubuntu 20.04+:**

```bash
# 1. –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -

# 2. –û–±–Ω–æ–≤–ª—è–µ–º –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
sudo apt update
sudo apt install -y postgresql-14 postgresql-contrib-14

# 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º
sudo systemctl status postgresql
```

---

## üóÑÔ∏è –ù–ê–°–¢–†–û–ô–ö–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•

### **1. –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ë–î:**

```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è postgres
sudo -u postgres psql

# –í psql –≤—ã–ø–æ–ª–Ω—è–µ–º:
CREATE DATABASE calculator_db;
CREATE USER calculator_user WITH ENCRYPTED PASSWORD '–≤–∞—à_—Å–ª–æ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å';
GRANT ALL PRIVILEGES ON DATABASE calculator_db TO calculator_user;

# –î–ª—è PostgreSQL 15+:
\c calculator_db
GRANT ALL ON SCHEMA public TO calculator_user;

# –í—ã—Ö–æ–¥–∏–º
\q
```

### **2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø:**

```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º pg_hba.conf
sudo nano /var/lib/pgsql/14/data/pg_hba.conf

# –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞):
host    calculator_db    calculator_user    127.0.0.1/32    md5

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º PostgreSQL
sudo systemctl restart postgresql-14
```

### **3. –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ö–µ–º—É:**

```bash
# –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª postgresql_schema.sql –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp postgresql_schema.sql root@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:/tmp/

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
sudo -u postgres psql -d calculator_db -f /tmp/postgresql_schema.sql
```

### **4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É:**

```bash
sudo -u postgres psql -d calculator_db

# –í psql:
\dt                          # –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
SELECT COUNT(*) FROM parts;  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 0
\q
```

---

## üêò –£–°–¢–ê–ù–û–í–ö–ê PHP –ò –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô

### **CentOS 7:**

```bash
# 1. –î–æ–±–∞–≤–ª—è–µ–º EPEL –∏ Remi —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
sudo yum install -y epel-release
sudo yum install -y http://rpms.remirepo.net/enterprise/remi-release-7.rpm

# 2. –í–∫–ª—é—á–∞–µ–º PHP 8.0
sudo yum install -y yum-utils
sudo yum-config-manager --enable remi-php80

# 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º PHP –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
sudo yum install -y php php-cli php-fpm php-pgsql php-curl php-json php-mbstring php-xml

# 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º
php -v
php -m | grep pgsql  # –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ pgsql
```

### **Ubuntu:**

```bash
sudo apt install -y php8.0 php8.0-cli php8.0-fpm php8.0-pgsql php8.0-curl php8.0-json php8.0-mbstring php8.0-xml
```

---

## üîå –£–°–¢–ê–ù–û–í–ö–ê PHP API

### **1. –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:**

```bash
sudo mkdir -p /var/www/calculator-api
sudo chown -R nginx:nginx /var/www/calculator-api  # –ò–ª–∏ apache:apache
```

### **2. –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª—ã:**

```bash
# –ö–æ–ø–∏—Ä—É–µ–º api.php –∏ tme_sync.php
scp api.php root@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:/var/www/calculator-api/
scp tme_sync.php root@–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:/var/www/calculator-api/
```

### **3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º api.php:**

```bash
sudo nano /var/www/calculator-api/api.php

# –ò–∑–º–µ–Ω—è–µ–º —Å—Ç—Ä–æ–∫–∏:
define('DB_HOST', 'localhost');
define('DB_NAME', 'calculator_db');
define('DB_USER', 'calculator_user');
define('DB_PASS', '–≤–∞—à_–ø–∞—Ä–æ–ª—å');

# Nexar credentials —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –∏–∑ –≤–∞—à–µ–≥–æ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
```

### **4. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Nginx:**

```bash
sudo nano /etc/nginx/conf.d/calculator-api.conf
```

–í—Å—Ç–∞–≤–ª—è–µ–º:

```nginx
server {
    listen 80;
    server_name api.components.tools;
    
    root /var/www/calculator-api;
    index api.php;
    
    # API endpoint
    location /api {
        try_files $uri $uri/ /api.php?$query_string;
    }
    
    # PHP –æ–±—Ä–∞–±–æ—Ç–∫–∞
    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;
        fastcgi_index api.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
    
    # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
    location ~ /\.ht {
        deny all;
    }
}
```

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º
sudo nginx -t
sudo systemctl restart nginx
```

---

## üîê –ù–ê–°–¢–†–û–ô–ö–ê NEXAR/OCTOPART

### **1. –î–æ–±–∞–≤–ª—è–µ–º Redirect URL –≤ Nexar Console:**

–û—Ç–∫—Ä–æ–π—Ç–µ: https://portal.nexar.com/apps/[–≤–∞—à-app-id]/authorization

–í –ø–æ–ª–µ "–î–û–ë–ê–í–ò–¢–¨ URL-–ê–î–†–ï–°:" –¥–æ–±–∞–≤—å—Ç–µ:
```
https://components.tools/calculator/oauth/callback
https://api.components.tools/oauth/callback
```

–ù–∞–∂–º–∏—Ç–µ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–¥–µ–ª"

### **2. –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**

```bash
curl "http://api.components.tools/api/octopart/search?mpn=ATmega328P"
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–µ—Ç–∞–ª–∏.

---

## üõí –ù–ê–°–¢–†–û–ô–ö–ê TME API

### **1. –ü–æ–ª—É—á–∞–µ–º API –∫–ª—é—á–∏ TME:**

1. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://www.tme.eu/
2. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –≤ "–ú–æ–π –∞–∫–∫–∞—É–Ω—Ç" ‚Üí "API"
3. –°–æ–∑–¥–∞–µ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–∞–µ—Ç–µ:
   - API Key
   - API Secret

### **2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º tme_sync.php:**

```bash
sudo nano /var/www/calculator-api/tme_sync.php

# –ò–∑–º–µ–Ω—è–µ–º:
$tmeSync = new TMESync(
    '–í–ê–®_TME_API_KEY',
    '–í–ê–®_TME_API_SECRET',
    $db
);
```

### **3. –¢–µ—Å—Ç–∏—Ä—É–µ–º:**

```bash
cd /var/www/calculator-api
php tme_sync.php --mode=search --mpn=ATmega328P
```

–î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–µ—Ç–∞–ª–∏.

---

## üåê –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–û–í

### **1. –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**

```bash
sudo mkdir -p /var/www/components.tools/calculator
sudo mkdir -p /var/www/components.tools/calculator/manager
```

### **2. –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª—ã:**

```bash
# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
scp calculator_components_tools.html root@—Å–µ—Ä–≤–µ—Ä:/var/www/components.tools/calculator/index.html

# –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
scp calculator_manager.html root@—Å–µ—Ä–≤–µ—Ä:/var/www/components.tools/calculator/manager/index.html

# Excel –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä (–¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è)
scp calculator_v2.xlsx root@—Å–µ—Ä–≤–µ—Ä:/var/www/components.tools/calculator/calculator.xlsx
```

### **3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞:**

```bash
sudo chown -R nginx:nginx /var/www/components.tools
sudo chmod -R 755 /var/www/components.tools
```

### **4. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Nginx –¥–ª—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–≤:**

```bash
sudo nano /etc/nginx/conf.d/components-tools.conf
```

```nginx
server {
    listen 80;
    server_name components.tools www.components.tools;
    
    root /var/www/components.tools;
    index index.html;
    
    # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
    location /calculator {
        try_files $uri $uri/ /calculator/index.html;
    }
    
    # –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
    location /calculator/manager {
        try_files $uri $uri/ /calculator/manager/index.html;
    }
    
    # –ü—Ä–æ–∫—Å–∏ –∫ API
    location /api {
        proxy_pass http://api.components.tools;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

```bash
sudo nginx -t
sudo systemctl restart nginx
```

### **5. –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø:**

- –ê–¥–º–∏–Ω: https://components.tools/calculator/
- –ú–µ–Ω–µ–¥–∂–µ—Ä: https://components.tools/calculator/manager/

---

## üîÑ –°–û–ó–î–ê–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô

### **1. –°–æ–∑–¥–∞–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:**

```bash
sudo -u postgres psql -d calculator_db

INSERT INTO users (username, password_hash, email, role, default_profit_percent)
VALUES (
    'admin',
    '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', -- –ø–∞—Ä–æ–ª—å: admin123
    'admin@components.tools',
    'admin',
    25.00
);
```

### **2. –°–æ–∑–¥–∞–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:**

```bash
# –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞:
INSERT INTO users (username, password_hash, email, role, default_profit_percent)
VALUES (
    'manager1',
    '$2y$10$—Ö—ç—à_–ø–∞—Ä–æ–ª—è', -- –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ password_hash()
    'manager1@components.tools',
    'manager',
    25.00
);
```

–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ö—ç—à–∞ –ø–∞—Ä–æ–ª—è:
```php
<?php
echo password_hash('–Ω–æ–≤—ã–π_–ø–∞—Ä–æ–ª—å', PASSWORD_BCRYPT);
?>
```

---

## üîÑ –ê–í–¢–û–ú–ê–¢–ò–ó–ê–¶–ò–Ø –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò

### **1. –°–æ–∑–¥–∞–µ–º cron –∑–∞–¥–∞–Ω–∏—è:**

```bash
sudo crontab -e
```

–î–æ–±–∞–≤–ª—è–µ–º:

```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è TME –∫–∞–∂–¥—ã–µ 2 —á–∞—Å–∞
0 */2 * * * cd /var/www/calculator-api && php tme_sync.php --mode=queue --batch=100 >> /var/log/tme_sync.log 2>&1

# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤ –∫–∞–∂–¥—É—é –Ω–æ—á—å –≤ 3:00
0 3 * * * psql -U calculator_user -d calculator_db -c "SELECT cleanup_old_logs(30);" >> /var/log/db_cleanup.log 2>&1

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∫–∞–∂–¥—ã–π —á–∞—Å
0 * * * * psql -U calculator_user -d calculator_db -c "SELECT cleanup_expired_cache();" >> /var/log/cache_cleanup.log 2>&1

# –ë—ç–∫–∞–ø –ë–î –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 4:00
0 4 * * * pg_dump -U calculator_user calculator_db | gzip > /backups/calculator_db_$(date +\%Y\%m\%d).sql.gz
```

### **2. –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –ª–æ–≥–æ–≤:**

```bash
sudo mkdir -p /var/log/calculator
sudo mkdir -p /backups
sudo chown calculator_user:calculator_user /var/log/calculator
sudo chown calculator_user:calculator_user /backups
```

---

## üîó –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° –ë–ò–¢–†–ò–ö–°

### **–ú–æ–¥—É–ª—å –¥–ª—è –ë–∏—Ç—Ä–∏–∫—Å (PHP):**

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/local/modules/componenttools.calculator/`:

```php
<?php
// /local/modules/componenttools.calculator/lib/sync.php

namespace ComponentTools\Calculator;

use Bitrix\Main\Loader;

class Sync {
    private $apiUrl = 'https://api.components.tools/api';
    
    /**
     * –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–µ—Ç–∞–ª–µ–π –∏–∑ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥ –ë–∏—Ç—Ä–∏–∫—Å
     */
    public function syncParts($limit = 100) {
        Loader::includeModule('iblock');
        
        // –ü–æ–ª—É—á–∞–µ–º –¥–µ—Ç–∞–ª–∏ –∏–∑ API
        $response = file_get_contents($this->apiUrl . '/parts/list?limit=' . $limit);
        $data = json_decode($response, true);
        
        if (!$data['success']) {
            return false;
        }
        
        foreach ($data['data'] as $part) {
            $this->syncPart($part);
        }
        
        return true;
    }
    
    /**
     * –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –æ–¥–Ω–æ–π –¥–µ—Ç–∞–ª–∏
     */
    private function syncPart($partData) {
        $iblockId = 17; // ID –≤–∞—à–µ–≥–æ –∏–Ω—Ñ–æ–±–ª–æ–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞
        
        // –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ –≤–Ω–µ—à–Ω–µ–º—É –∫–æ–¥—É
        $arFilter = ['IBLOCK_ID' => $iblockId, 'EXTERNAL_ID' => 'PART_' . $partData['id']];
        $rsElement = \CIBlockElement::GetList([], $arFilter, false, false, ['ID']);
        
        $fields = [
            'IBLOCK_ID' => $iblockId,
            'NAME' => $partData['mpn'] . ' - ' . $partData['manufacturer_name'],
            'ACTIVE' => 'Y',
            'EXTERNAL_ID' => 'PART_' . $partData['id'],
            'PROPERTY_VALUES' => [
                'MPN' => $partData['mpn'],
                'MANUFACTURER' => $partData['manufacturer_name'],
                'DESCRIPTION' => $partData['description'],
                'PRICE' => $partData['our_price_rub'],
                'QUANTITY' => $partData['our_stock'],
                'DELIVERY_DAYS' => $partData['our_delivery_days']
            ]
        ];
        
        $el = new \CIBlockElement;
        
        if ($arElement = $rsElement->Fetch()) {
            // –û–±–Ω–æ–≤–ª—è–µ–º
            $el->Update($arElement['ID'], $fields);
        } else {
            // –°–æ–∑–¥–∞–µ–º
            $el->Add($fields);
        }
    }
}
```

### **–ê–≥–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

```php
// /local/php_interface/init.php

use ComponentTools\Calculator\Sync;

// –î–æ–±–∞–≤–ª—è–µ–º –∞–≥–µ–Ω—Ç –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∫–∞–∂–¥—ã–µ 2 —á–∞—Å–∞
\CAgent::AddAgent(
    "\\ComponentTools\\Calculator\\Sync::syncParts(100);",
    "",
    "N",
    7200, // 2 —á–∞—Å–∞
    "",
    "Y",
    "",
    1
);
```

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã API:**

```bash
# –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –¥–µ—Ç–∞–ª–∏
curl "https://api.components.tools/api/octopart/search?mpn=ATmega328P"

# –¢–µ—Å—Ç –ø—Ä–æ—Ñ–∏–ª—è
curl "https://api.components.tools/api/profile/active"
```

### **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î:**

```bash
sudo -u postgres psql -d calculator_db

-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–∞–ª–µ–π
SELECT COUNT(*) FROM parts;

-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å—á–µ—Ç–æ–≤
SELECT COUNT(*) FROM calculations;

-- –¢–æ–ø –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
SELECT * FROM v_manager_stats;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–µ—Ç–∞–ª—è–º
SELECT 
    category,
    COUNT(*) as total,
    SUM(CASE WHEN tme_price_eur IS NOT NULL THEN 1 ELSE 0 END) as with_tme_price
FROM parts
GROUP BY category;
```

### **3. –õ–æ–≥–∏:**

```bash
# –õ–æ–≥–∏ TME —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
tail -f /var/log/tme_sync.log

# –õ–æ–≥–∏ Nginx
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log

# –õ–æ–≥–∏ PostgreSQL
tail -f /var/lib/pgsql/14/data/log/postgresql-*.log
```

---

## üéØ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –°–ò–°–¢–ï–ú–´

### **1. –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –¥–µ—Ç–∞–ª–∏ —á–µ—Ä–µ–∑ Nexar:**

```bash
curl "https://api.components.tools/api/octopart/search?mpn=ATmega328P"
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "data": {
    "found": true,
    "mpn": "ATmega328P",
    "manufacturer": "Microchip",
    ...
  }
}
```

### **2. –¢–µ—Å—Ç TME —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**

```bash
cd /var/www/calculator-api
php tme_sync.php --mode=search --mpn=STM32F103C8T6
```

### **3. –¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã:**

```bash
curl -X POST "https://api.components.tools/api/calculate" \
  -H "Content-Type: application/json" \
  -d '{
    "purchasePriceEur": 5.50,
    "desiredProfitPercent": 25
  }'
```

---

## üÜò –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### **–ü—Ä–æ–±–ª–µ–º–∞: API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ PHP-FPM
sudo systemctl status php-fpm

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo systemctl restart php-fpm

# –õ–æ–≥–∏
tail -f /var/log/php-fpm/error.log
```

### **–ü—Ä–æ–±–ª–µ–º–∞: –ë–î –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ PostgreSQL
sudo systemctl status postgresql-14

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
psql -U calculator_user -d calculator_db -h localhost

# –ï—Å–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ pg_hba.conf
```

### **–ü—Ä–æ–±–ª–µ–º–∞: Nexar API –æ—à–∏–±–∫–∏**

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. Credentials –≤ api.php
2. Redirect URLs –≤ Nexar Console
3. –õ–æ–≥–∏: `/var/log/nginx/error.log`

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–°–£–†–°–´

- **TME API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://api-doc.tme.eu/
- **Nexar API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://support.nexar.com/
- **PostgreSQL –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://www.postgresql.org/docs/
- **–ë–∏—Ç—Ä–∏–∫—Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É:** https://dev.1c-bitrix.ru/

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –£–°–¢–ê–ù–û–í–ö–ò

- [ ] PostgreSQL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –∏ —Å—Ö–µ–º–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
- [ ] PHP –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] API —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] Nexar/Octopart –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] TME API –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞–Ω—ã
- [ ] Cron –∑–∞–¥–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –ë—ç–∫–∞–ø—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã

---

üéâ **–°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï!**

–¢–µ–ø–µ—Ä—å –≤–∞—à–∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –º–æ–≥—É—Ç:
- –ò—Å–∫–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É
- –ü–æ–ª—É—á–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã
- –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —Ü–µ–Ω—É –ø—Ä–æ–¥–∞–∂–∏
- –í—ã—Å—Ç–∞–≤–ª—è—Ç—å —Å—á–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞–º

–ê –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç:
- –£–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—á–µ—Ç—ã
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –ë–∏—Ç—Ä–∏–∫—Å/OpenCart
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω

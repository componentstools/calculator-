<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–º–ø–æ—Ä—Ç–∞ –∏–∑ –ï–≤—Ä–æ–ø—ã</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #366092 0%, #4a7bb0 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        @media (max-width: 1200px) {
            .content {
                grid-template-columns: 1fr;
            }
        }

        .section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            border: 2px solid #e9ecef;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: #366092;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #366092;
        }

        .input-group {
            margin-bottom: 18px;
        }

        .input-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #495057;
            margin-bottom: 6px;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s;
            background: white;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #366092;
            box-shadow: 0 0 0 3px rgba(54, 96, 146, 0.1);
        }

        .input-hint {
            font-size: 12px;
            color: #6c757d;
            margin-top: 4px;
        }

        .result-section {
            background: linear-gradient(135deg, #00b050 0%, #00d460 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,176,80,0.3);
        }

        .result-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .result-value {
            font-size: 42px;
            font-weight: 700;
            margin: 10px 0;
        }

        .result-subtitle {
            font-size: 14px;
            opacity: 0.8;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #366092 0%, #4a7bb0 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(54, 96, 146, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(54, 96, 146, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .competitor-analysis {
            background: linear-gradient(135deg, #ffc000 0%, #ffb000 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .expense-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .expense-item:last-child {
            border-bottom: none;
        }

        .expense-label {
            font-weight: 600;
            color: #495057;
        }

        .expense-value {
            font-weight: 700;
            color: #366092;
        }

        .optimization-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 4px solid #00b050;
        }

        .optimization-title {
            font-weight: 700;
            color: #212529;
            margin-bottom: 5px;
        }

        .optimization-value {
            font-size: 24px;
            font-weight: 700;
            color: #00b050;
        }

        .toggle-section {
            margin-top: 20px;
            padding: 15px;
            background: #e7f3ff;
            border-radius: 8px;
            border-left: 4px solid #366092;
        }

        .recommendations {
            background: #fff3cd;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #ffc107;
            margin-top: 20px;
        }

        .recommendations h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .recommendations ul {
            list-style: none;
            padding: 0;
        }

        .recommendations li {
            padding: 10px 0;
            border-bottom: 1px solid #ffeeba;
        }

        .recommendations li:last-child {
            border-bottom: none;
        }

        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
        }

        .status-danger {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–º–ø–æ—Ä—Ç–∞ –∏–∑ –ï–≤—Ä–æ–ø—ã</h1>
            <p>–†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –ø—Ä–æ–¥–∞–∂–∏ –∏ —Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å</p>
        </div>

        <div class="content">
            <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê - –í–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï -->
            <div>
                <!-- 1. –ó–∞–∫—É–ø–∫–∞ -->
                <div class="section">
                    <div class="section-title">1. –ó–∞–∫—É–ø–∫–∞ –≤ –ï–≤—Ä–æ–ø–µ</div>
                    <div class="input-group">
                        <label>–ó–∞–∫—É–ø–∫–∞ —Ç–æ–≤–∞—Ä–∞ (‚Ç¨)</label>
                        <input type="number" id="zakupka" value="0" step="0.01">
                        <div class="input-hint">–¶–µ–Ω–∞ —É –µ–≤—Ä–æ–ø–µ–π—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</div>
                    </div>
                    <div class="input-group">
                        <label>–î–æ—Å—Ç–∞–≤–∫–∞ –¥–æ 2 –∫–≥ (‚Ç¨)</label>
                        <input type="number" id="dostavka2kg" value="35" step="0.01">
                        <div class="input-hint">35‚Ç¨ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ, –∏–ª–∏ 0 –µ—Å–ª–∏ –±–æ–ª—å—à–µ 2–∫–≥</div>
                    </div>
                    <div class="input-group">
                        <label>–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –∏–Ω–≤–æ–π—Å—É (‚Ç¨)</label>
                        <input type="number" id="dostavkaInvoice" value="0" step="0.01">
                        <div class="input-hint">–ï—Å–ª–∏ –≤–µ—Å > 2 –∫–≥</div>
                    </div>
                </div>

                <!-- 2. –°–ø–æ—Å–æ–± –ø–µ—Ä–µ–≤–æ–¥–∞ -->
                <div class="section">
                    <div class="section-title">2. –°–ø–æ—Å–æ–± –ø–µ—Ä–µ–≤–æ–¥–∞</div>
                    <div class="input-group">
                        <label>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–±</label>
                        <select id="sposob">
                            <option value="1">–ù–∞–ª–∏—á–∫–∞ —á–µ—Ä–µ–∑ –ò–ü</option>
                            <option value="2">–ö—Ä–∏–ø—Ç–∞ (EUR‚ÜíUSDT‚ÜíRUB)</option>
                        </select>
                    </div>

                    <div id="nalichkaBlock">
                        <div class="input-group">
                            <label>–ö—É—Ä—Å EUR/RUB</label>
                            <input type="number" id="kursNalichka" value="105" step="0.01">
                        </div>
                        <div class="input-group">
                            <label>–ö–æ–º–∏—Å—Å–∏—è –ò–ü (%)</label>
                            <input type="number" id="komisIP" value="10" step="0.1">
                            <div class="input-hint">–û–±—ã—á–Ω–æ 10%</div>
                        </div>
                    </div>

                    <div id="kriptaBlock" style="display:none;">
                        <div class="input-group">
                            <label>–ö—É—Ä—Å EUR/USDT</label>
                            <input type="number" id="kursEurUsdt" value="1.19" step="0.0001">
                        </div>
                        <div class="input-group">
                            <label>–ö—É—Ä—Å USDT/RUB</label>
                            <input type="number" id="kursUsdtRub" value="83.43" step="0.01">
                        </div>
                        <div class="input-group">
                            <label>–ö–æ–º–∏—Å—Å–∏—è (%)</label>
                            <input type="number" id="komisKripta" value="2" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>–ö–æ–º–∏—Å—Å–∏—è –∞–≥–µ–Ω—Ç–∞ (‚ÇΩ)</label>
                            <input type="number" id="komisAgent" value="19908.72" step="0.01">
                        </div>
                    </div>
                </div>

                <!-- 3. –õ–æ–≥–∏—Å—Ç–∏–∫–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã -->
                <div class="section">
                    <div class="section-title">3. –õ–æ–≥–∏—Å—Ç–∏–∫–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã</div>
                    <div class="input-group">
                        <label>–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –†–æ—Å—Å–∏–∏ (‚ÇΩ)</label>
                        <input type="number" id="dostavkaRF" value="0" step="0.01">
                        <div class="input-hint">–ü–æ—Å–ª–µ–¥–Ω—è—è –º–∏–ª—è</div>
                    </div>
                    <div class="input-group">
                        <label>–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–∫—É–ø–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (%)</label>
                        <input type="number" id="stoimostDocs" value="10" step="0.1">
                        <div class="input-hint">–û–±—ã—á–Ω–æ 10%</div>
                    </div>
                    <div class="input-group">
                        <label>–¶–µ–ª–µ–≤–∞—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å (%)</label>
                        <input type="number" id="celProfit" value="3" step="0.1">
                        <div class="input-hint">–î–ª—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–∏, –æ–±—ã—á–Ω–æ 3%</div>
                    </div>
                </div>

                <!-- 4. –ñ–µ–ª–∞–µ–º–∞—è –ø—Ä–∏–±—ã–ª—å -->
                <div class="section">
                    <div class="section-title">4. –ñ–µ–ª–∞–µ–º–∞—è –ø—Ä–∏–±—ã–ª—å</div>
                    <div class="input-group">
                        <label>–ñ–µ–ª–∞–µ–º–∞—è –†–ï–ê–õ–¨–ù–ê–Ø –ø—Ä–∏–±—ã–ª—å (‚ÇΩ)</label>
                        <input type="number" id="jelaemayaPribil" value="0" step="0.01">
                        <div class="input-hint">–°–∫–æ–ª—å–∫–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Ä—É–∫–∞—Ö</div>
                    </div>
                </div>

                <!-- 5. –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã -->
                <div class="section">
                    <div class="section-title">5. –¶–µ–Ω—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</div>
                    <div class="input-group">
                        <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (‚ÇΩ)</label>
                        <input type="number" id="konkurentMin" value="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (‚ÇΩ)</label>
                        <input type="number" id="konkurentMax" value="0" step="0.01">
                    </div>
                </div>

                <button class="btn" onclick="calculate()">üöÄ –†–ê–°–°–ß–ò–¢–ê–¢–¨ –¶–ï–ù–£</button>
            </div>

            <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê - –†–ï–ó–£–õ–¨–¢–ê–¢–´ -->
            <div>
                <!-- –ì–ª–∞–≤–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç -->
                <div class="result-section">
                    <div class="result-title">üí∞ –¶–ï–ù–ê –ü–†–û–î–ê–ñ–ò –î–õ–Ø –ö–õ–ò–ï–ù–¢–ê</div>
                    <div class="result-value" id="resultPrice">0 ‚ÇΩ</div>
                    <div class="result-subtitle">–í—ã—Å—Ç–∞–≤–∏—Ç—å —Å—á–µ—Ç –Ω–∞ —ç—Ç—É —Å—É–º–º—É</div>
                </div>

                <!-- –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ -->
                <div class="competitor-analysis" id="competitorBlock" style="display:none;">
                    <h3 style="margin-bottom:15px;">üìä –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</h3>
                    <div style="font-size:18px; margin-bottom:10px;">
                        –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: <span id="competitorAvg" style="font-weight:700;">0 ‚ÇΩ</span>
                    </div>
                    <div style="font-size:16px; margin-bottom:10px;">
                        –†–∞–∑–Ω–∏—Ü–∞: <span id="competitorDiff" style="font-weight:700;">0 ‚ÇΩ</span>
                        (<span id="competitorDiffPercent">0%</span>)
                    </div>
                    <div id="competitorStatus"></div>
                </div>

                <!-- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
                <div class="section">
                    <div class="section-title">üìà –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤</div>
                    <div id="expensesList"></div>
                </div>

                <!-- –°—Ü–µ–Ω–∞—Ä–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ -->
                <div class="section">
                    <div class="section-title">üí° –°—Ü–µ–Ω–∞—Ä–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</div>
                    <div id="optimizationList"></div>
                    <div style="margin-top:20px; padding:15px; background:#e8f5e9; border-radius:8px;">
                        <div style="font-weight:600; margin-bottom:5px;">–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:</div>
                        <div style="font-size:28px; font-weight:700; color:#00b050;" id="totalOptimization">0 ‚ÇΩ</div>
                        <div style="font-size:14px; margin-top:5px;">–ü—Ä–∏–±—ã–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å: <span style="font-weight:700;" id="maxProfit">0 ‚ÇΩ</span></div>
                    </div>
                </div>

                <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ -->
                <div class="recommendations">
                    <h3>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</h3>
                    <ul id="recommendationsList"></ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Å–ø–æ—Å–æ–±–∞
        document.getElementById('sposob').addEventListener('change', function() {
            const sposob = this.value;
            document.getElementById('nalichkaBlock').style.display = sposob === '1' ? 'block' : 'none';
            document.getElementById('kriptaBlock').style.display = sposob === '2' ? 'block' : 'none';
        });

        function calculate() {
            // –ü–æ–ª—É—á–∞–µ–º –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            const zakupka = parseFloat(document.getElementById('zakupka').value) || 0;
            const dostavka2kg = parseFloat(document.getElementById('dostavka2kg').value) || 0;
            const dostavkaInvoice = parseFloat(document.getElementById('dostavkaInvoice').value) || 0;
            const sposob = document.getElementById('sposob').value;
            const dostavkaRF = parseFloat(document.getElementById('dostavkaRF').value) || 0;
            const stoimostDocs = (parseFloat(document.getElementById('stoimostDocs').value) || 10) / 100;
            const celProfit = (parseFloat(document.getElementById('celProfit').value) || 3) / 100;
            const jelaemayaPribil = parseFloat(document.getElementById('jelaemayaPribil').value) || 0;
            const konkurentMin = parseFloat(document.getElementById('konkurentMin').value) || 0;
            const konkurentMax = parseFloat(document.getElementById('konkurentMax').value) || 0;

            // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–ø–æ—Å–æ–±–∞ –ø–µ—Ä–µ–≤–æ–¥–∞
            let kurs, komisPerevod, komisAgent = 0;
            if (sposob === '1') {
                kurs = parseFloat(document.getElementById('kursNalichka').value) || 105;
                komisPerevod = (parseFloat(document.getElementById('komisIP').value) || 10) / 100;
            } else {
                const kursEurUsdt = parseFloat(document.getElementById('kursEurUsdt').value) || 1.19;
                const kursUsdtRub = parseFloat(document.getElementById('kursUsdtRub').value) || 83.43;
                const komisKripta = (parseFloat(document.getElementById('komisKripta').value) || 2) / 100;
                komisAgent = parseFloat(document.getElementById('komisAgent').value) || 19908.72;
                kurs = kursEurUsdt * kursUsdtRub;
                komisPerevod = komisKripta;
            }

            const nds = 0.20;
            const nalogNaPribil = 0.20;

            // –†–∞—Å—á–µ—Ç—ã
            const dostavkaEvropa = dostavka2kg + dostavkaInvoice;
            const nujnoVEvrope = zakupka + dostavkaEvropa;
            
            // –†–∞—Å—á–µ—Ç —Å—É–º–º—ã –∫ –≤—ã–≤–æ–¥—É
            let kVivodu;
            if (sposob === '1') {
                const sKomisiej = nujnoVEvrope * (1 + komisPerevod);
                const vRublyah = sKomisiej * kurs;
                const komisIP = vRublyah * komisPerevod;
                kVivodu = vRublyah + komisIP;
            } else {
                const sKomisiej = nujnoVEvrope * (1 + komisPerevod);
                const vUsdt = sKomisiej * (kurs / ((1 + komisPerevod) * kurs));
                const vRublyah = sKomisiej * kurs;
                kVivodu = vRublyah + komisAgent;
            }

            const zakupkaRub = zakupka * kurs;
            const dostavkaEvropaRub = dostavkaEvropa * kurs;
            
            // –ü—Ä—è–º—ã–µ —Ä–∞—Å—Ö–æ–¥—ã
            const pryamieRashodi = kVivodu + dostavkaRF;

            // –§–æ—Ä–º—É–ª–∞ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞
            const viruchkaBezNDS = (jelaemayaPribil + pryamieRashodi) / (1 - stoimostDocs * (1 - celProfit) - celProfit * nalogNaPribil);
            
            const ndsSum = viruchkaBezNDS * nds;
            const cenaProdaji = viruchkaBezNDS + ndsSum;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—á–µ—Ç–æ–≤
            const perviyPrihod = zakupkaRub * 0.10;
            const celevayaPribil = viruchkaBezNDS * celProfit;
            const dopPrihod = viruchkaBezNDS - perviyPrihod - celevayaPribil;
            const stoimostDokov = (perviyPrihod + dopPrihod) * stoimostDocs;
            const nalogNaPribilSum = celevayaPribil * nalogNaPribil;

            // –í—ã–≤–æ–¥ –≥–ª–∞–≤–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            document.getElementById('resultPrice').textContent = cenaProdaji.toLocaleString('ru-RU', {minimumFractionDigits: 2, maximumFractionDigits: 2}) + ' ‚ÇΩ';

            // –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
            if (konkurentMin > 0 || konkurentMax > 0) {
                const avgKonkurent = (konkurentMin + konkurentMax) / 2;
                const diff = cenaProdaji - avgKonkurent;
                const diffPercent = (diff / avgKonkurent * 100).toFixed(1);
                
                document.getElementById('competitorBlock').style.display = 'block';
                document.getElementById('competitorAvg').textContent = avgKonkurent.toLocaleString('ru-RU', {minimumFractionDigits: 2}) + ' ‚ÇΩ';
                document.getElementById('competitorDiff').textContent = diff.toLocaleString('ru-RU', {minimumFractionDigits: 2, maximumFractionDigits: 2}) + ' ‚ÇΩ';
                document.getElementById('competitorDiffPercent').textContent = (diff > 0 ? '+' : '') + diffPercent + '%';
                
                const status = diff > 0 ? 
                    '<span class="status-badge status-danger">‚ùå –ú–´ –î–û–†–û–ñ–ï</span>' :
                    '<span class="status-badge status-success">‚úÖ –ú–´ –î–ï–®–ï–í–õ–ï</span>';
                document.getElementById('competitorStatus').innerHTML = status;
            } else {
                document.getElementById('competitorBlock').style.display = 'none';
            }

            // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤
            const rashodi = [
                {label: '–ó–∞–∫—É–ø–∫–∞', value: zakupkaRub, percent: zakupkaRub / cenaProdaji * 100},
                {label: '–î–æ—Å—Ç–∞–≤–∫–∞ –ï–≤—Ä–æ–ø–∞', value: dostavkaEvropaRub, percent: dostavkaEvropaRub / cenaProdaji * 100},
                {label: '–ö–æ–º–∏—Å—Å–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞', value: kVivodu - zakupkaRub - dostavkaEvropaRub, percent: (kVivodu - zakupkaRub - dostavkaEvropaRub) / cenaProdaji * 100},
                {label: '–î–æ—Å—Ç–∞–≤–∫–∞ –†–§', value: dostavkaRF, percent: dostavkaRF / cenaProdaji * 100},
                {label: '–ü–æ–∫—É–ø–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤', value: stoimostDokov, percent: stoimostDokov / cenaProdaji * 100},
                {label: '–ù–î–°', value: ndsSum, percent: ndsSum / cenaProdaji * 100},
                {label: '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å', value: nalogNaPribilSum, percent: nalogNaPribilSum / cenaProdaji * 100},
            ];

            let expensesHTML = '';
            rashodi.forEach(r => {
                expensesHTML += `
                    <div class="expense-item">
                        <span class="expense-label">${r.label}</span>
                        <span class="expense-value">${r.value.toLocaleString('ru-RU', {minimumFractionDigits: 2})} ‚ÇΩ (${r.percent.toFixed(1)}%)</span>
                    </div>
                `;
            });
            
            const totalRashodi = rashodi.reduce((sum, r) => sum + r.value, 0);
            expensesHTML += `
                <div class="expense-item" style="border-top: 3px solid #366092; margin-top: 10px; padding-top: 15px;">
                    <span class="expense-label" style="font-size: 16px;">–ò–¢–û–ì–û —Ä–∞—Å—Ö–æ–¥—ã</span>
                    <span class="expense-value" style="font-size: 16px;">${totalRashodi.toLocaleString('ru-RU', {minimumFractionDigits: 2})} ‚ÇΩ (${(totalRashodi / cenaProdaji * 100).toFixed(1)}%)</span>
                </div>
                <div class="expense-item">
                    <span class="expense-label" style="color: #00b050; font-size: 16px;">–ü—Ä–∏–±—ã–ª—å</span>
                    <span class="expense-value" style="color: #00b050; font-size: 16px;">${jelaemayaPribil.toLocaleString('ru-RU', {minimumFractionDigits: 2})} ‚ÇΩ (${(jelaemayaPribil / cenaProdaji * 100).toFixed(1)}%)</span>
                </div>
            `;
            document.getElementById('expensesList').innerHTML = expensesHTML;

            // –°—Ü–µ–Ω–∞—Ä–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
            const scenarios = [];
            
            if (sposob === '1' && komisPerevod > 0.08) {
                const ekonomiya = (komisPerevod - 0.08) * zakupkaRub * (1 + komisPerevod);
                scenarios.push({title: '–°–Ω–∏–∑–∏—Ç—å –∫–æ–º–∏—Å—Å–∏—é –ò–ü –¥–æ 8%', value: ekonomiya});
            }

            const ekonomiyaZakupka = 50 * kurs * (1 + komisPerevod + stoimostDocs);
            scenarios.push({title: '–ù–∞–π—Ç–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –¥–µ—à–µ–≤–ª–µ –Ω–∞ 50‚Ç¨', value: ekonomiyaZakupka});

            if (stoimostDocs > 0.08) {
                const ekonomiyaDocs = (stoimostDocs - 0.08) * viruchkaBezNDS * (1 - celProfit);
                scenarios.push({title: '–ü–æ–∫—É–ø–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ–¥ 8%', value: ekonomiyaDocs});
            }

            if (dostavkaRF > 0) {
                const ekonomiyaDostavka = dostavkaRF * 0.30;
                scenarios.push({title: '–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É –†–§ (-30%)', value: ekonomiyaDostavka});
            }

            if (celProfit > 0.02) {
                const ekonomiyaProfit = (celProfit - 0.02) * viruchkaBezNDS * stoimostDocs;
                scenarios.push({title: '–°–Ω–∏–∑–∏—Ç—å –æ—Ñ–∏—Ü. –ø—Ä–∏–±—ã–ª—å –¥–æ 2%', value: ekonomiyaProfit});
            }

            let optimizationHTML = '';
            let totalOptimization = 0;
            scenarios.forEach(s => {
                totalOptimization += s.value;
                optimizationHTML += `
                    <div class="optimization-item">
                        <div class="optimization-title">${s.title}</div>
                        <div class="optimization-value">+${s.value.toLocaleString('ru-RU', {minimumFractionDigits: 2})} ‚ÇΩ</div>
                    </div>
                `;
            });
            document.getElementById('optimizationList').innerHTML = optimizationHTML;
            document.getElementById('totalOptimization').textContent = totalOptimization.toLocaleString('ru-RU', {minimumFractionDigits: 2}) + ' ‚ÇΩ';
            document.getElementById('maxProfit').textContent = (jelaemayaPribil + totalOptimization).toLocaleString('ru-RU', {minimumFractionDigits: 2}) + ' ‚ÇΩ';

            // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
            const recommendations = [
                `<strong>–ö–æ–º–∏—Å—Å–∏—è –≤—ã–≤–æ–¥–∞</strong> - —Å–∞–º–∞—è –±–æ–ª—å—à–∞—è —Å—Ç–∞—Ç—å—è —Ä–∞—Å—Ö–æ–¥–æ–≤ (${((kVivodu - zakupkaRub - dostavkaEvropaRub) / cenaProdaji * 100).toFixed(1)}%). ${sposob === '1' ? '–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –∫—Ä–∏–ø—Ç—É –¥–ª—è —Å—É–º–º –æ—Ç 10 000‚Ç¨' : '–•–æ—Ä–æ—à–∏–π –≤—ã–±–æ—Ä –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å—É–º–º'}.`,
                `<strong>–ü–æ–∫—É–ø–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</strong> —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç ${(stoimostDokov / cenaProdaji * 100).toFixed(1)}% –æ—Ç –≤—ã—Ä—É—á–∫–∏. –ü–æ–∏—Å–∫ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –º–µ–Ω—å—à–µ–π –∫–æ–º–∏—Å—Å–∏–µ–π (8% –≤–º–µ—Å—Ç–æ 10%) –¥–∞—Å—Ç —ç–∫–æ–Ω–æ–º–∏—é ${((stoimostDocs - 0.08) * viruchkaBezNDS * (1 - celProfit)).toLocaleString('ru-RU', {minimumFractionDigits: 0})} ‚ÇΩ.`,
                `<strong>–ó–∞–∫—É–ø–∫–∞</strong> - ${(zakupkaRub / cenaProdaji * 100).toFixed(1)}% —Ä–∞—Å—Ö–æ–¥–æ–≤. –ü—Ä—è–º–æ–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–º –∏–ª–∏ –æ–ø—Ç–æ–≤—ã–µ —Å–∫–∏–¥–∫–∏ –º–æ–≥—É—Ç —Å–Ω–∏–∑–∏—Ç—å —ç—Ç—É —Å—Ç–∞—Ç—å—é –Ω–∞ 10-15%.`,
                `<strong>–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å</strong> —Ç–µ–∫—É—â–∞—è: ${(jelaemayaPribil / cenaProdaji * 100).toFixed(1)}%. ${jelaemayaPribil / cenaProdaji < 0.15 ? '–ù–∏–∑–∫–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å - —Ä–∏—Å–∫–∏ –≤—ã—Å–æ–∫–∏' : '–•–æ—Ä–æ—à–∞—è —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å'}.`,
            ];

            let recommendationsHTML = '';
            recommendations.forEach(r => {
                recommendationsHTML += `<li>${r}</li>`;
            });
            document.getElementById('recommendationsList').innerHTML = recommendationsHTML;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', calculate);
    </script>
</body>
</html>
